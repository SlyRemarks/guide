<!doctype html>
  <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html> <!--<![endif]-->

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>OpenHAB - Guide | OpenEnergyMonitor</title>
    <meta name="author" content="Glyn Hudson">
    <meta name="description" content="OpenHAB Integration">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="http://guide.openenergymonitor.org/integrations/openhab/">

    <meta property="fb:app_id" content="xxxxxxxxxxxxxxx">
    <meta property="og:title" content="OpenHAB">
    <meta property="og:site_name" content="Guide | OpenEnergyMonitor">
    <meta property="og:url" content="http://guide.openenergymonitor.org/integrations/openhab/">
    <meta property="og:type" content="website">
    <meta property="og:description" content="OpenHAB Integration">
    <meta property="og:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@openenergymon">
    
    <meta name="twitter:title" content="OpenHAB">
    <meta name="twitter:description" content="OpenHAB Integration">
    <meta name="twitter:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet">
    <link href="/atom.xml" rel="alternate" title="Guide | OpenEnergyMonitor" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />

    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="icon" sizes="16x16 32x32 64x64" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="196x196" href="/images/favicon-192.png">
    <link rel="icon" type="image/png" sizes="160x160" href="/images/favicon-160.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96.png">
    <link rel="icon" type="image/png" sizes="64x64" href="/images/favicon-64.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png">
    <link rel="apple-touch-icon" href="/images/favicon-57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/favicon-114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/favicon-72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/favicon-144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/favicon-60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/favicon-120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/favicon-76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/favicon-152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-180.png">
    <link rel="stylesheet" href="path/to/font-awesome/css/font-awesome.min.css">
    <meta name="msapplication-TileColor" content="#FFFFFF">
    <meta name="msapplication-TileImage" content="/images/favicon-144.png">
    <meta name="msapplication-config" content="/images/browserconfig.xml">
    
    <script>
    src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<script>
$(document).ready(function(){
    $("button").click(function(){
        $("p").toggle();
    });
});
</script>

    
   
     <!--<link href='https://fonts.googleapis.com/css?family=Raleway:400,400italic,700' rel='stylesheet' type='text/css' -->

  <body  onclick="parent.closeNav()">

    

    


          <article class="page">
  
    

  
  <header>
    <h1 class="title indent">
      OpenHAB
    </h1>
  </header>
  <hr class="divider">
  

  <p>Open Home Automation Bus (OpenHAB) is <em>“a vendor and technology agnostic open source automation software for your home”</em>. OpenHAB can run on an emonPi (Raspberry Pi) and is very flexible and can be configured for just about any home automation task. This high level of configurability can also make it seem quite hard to understand to start with.</p>

<p><strong>OpenHAB is pre-installed and setup on the latest emonSD Raspberry Pi images, see <a href="https://github.com/openenergymonitor/emonpi/wiki/emonSD-pre-built-SD-card-Download-&amp;-Change-Log">emonSD repository and change log</a>. If your running an emonSD image that includes OpenHAB browse to:</strong></p>

<h2 id="httpemonpi8080httpemonpi8080"><a href="http://emonpi:8080">http://emonpi:8080</a></h2>

<p><em>Substitite <code class="highlighter-rouge">emonpi</code> for your local emonpi’s IP address if hostname lookup does not work</em></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">Username</span><span class="pi">:</span> <span class="s2">"</span><span class="s">pi"</span>
<span class="s">Password</span><span class="pi">:</span> <span class="s2">"</span><span class="s">emonpi2016"</span>
</code></pre>
</div>

<p><img src="https://raw.githubusercontent.com/openenergymonitor/oem_openHab/master/images/web.png" alt="OpenHAB OpenEnergyMonitor" /></p>

<p>Pre installed on the emonPi is a skeleton config setup openHAB with to subscribe to data from the emonPi’s MQTT server (see <a href="/technical/mqtt/">MQTT docs</a>). For a full OpenHAB demo see the <a href="http://demo.openhab.org:8080/openhab.app?sitemap=demo">OpenHAB Demo House</a>.</p>

<h3 id="configuring-openhab">Configuring OpenHAB</h3>

<p>OpenHAB is configured from three main files:</p>

<ul>
  <li><strong><code class="highlighter-rouge">openhab.cfg</code></strong></li>
  <li><strong><code class="highlighter-rouge">&lt;sitemap-name&gt;.items</code></strong></li>
  <li><strong><code class="highlighter-rouge">&lt;sitemap-name&gt;.sitemap</code></strong></li>
</ul>

<p><em>In the openHAB emonPi install instructions (see docs link below) we recommend cloning the oem_openHAB to the /home directory then soft linking the <code class="highlighter-rouge">items</code> and <code class="highlighter-rouge">sitemap</code> files to the relevant config locations in <code class="highlighter-rouge">/etc/openhab/configurations/</code>. This makes the files easier to edit</em></p>

<p>It’s possible to have multiple user interfaces defined by multiple sitemaps e.g oem.sitemap, kids.sitemap or admin.sitemap etc. The default sitemap is default e.g. <code class="highlighter-rouge">default.items</code> and <code class="highlighter-rouge">default.sitemap</code>.</p>

<h4 id="openhabcfg">openhab.cfg</h4>

<p>This is the overall config file located in <code class="highlighter-rouge">/etc/openhab/configurations/</code>. In this file global config is set such as security authentication and MQTT server setting. E.g. to connect to emonPi local MQTT server the following is added:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>mqtt:mosquitto.url=tcp://localhost:1883
mqtt:mosquitto.user=emonpi
mqtt:mosquitto.pwd=emonpimqtt2016
mqtt:mosquitto.qos=2
mqtt:mosquitto.retain=true
</code></pre>
</div>

<p>See the full openhab.cfg file used for this example on the open_openhab GitHub repo (see docs link below).</p>

<h4 id="items">Items</h4>

<p>The items file defines all the ‘things’ you might want to view or control in openHAB. Items can be bound to ‘bindings’ which are optional packages that used to extend functionality of openHAB. This example makes use of the MQTT and HTTP bindings. The items file is located in <code class="highlighter-rouge">/etc/openhab/configurations/items</code>.</p>

<p>For example the line in the items file to subscribe to <em>emonPi Power 1</em> from emonhub MQTT is as follows:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Number emonpi_ct1 "Power 1 [%d W]" { mqtt="&lt;[mosquitto:emon/emonpi/power1:state:default]" }
</code></pre>
</div>

<p>The items file entry to <a href="/integrations/lightwaverf/">control LightWaveRF plug</a> (publish “1 1” to /lwrf mqtt topic) is as follows:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Switch lwrf1 "LWRF Socket 1" {mqtt="&gt;[mosquitto:lwrf:command:ON:1 1],&gt;[mosquitto:lwrf:command:OFF:1 0]"}
</code></pre>
</div>

<p>See the full items file used for this example on the open_openhab GitHub repo (see docs link below).</p>

<h4 id="sitemap">Sitemap</h4>

<p>The second openHAB config file of interest is ‘sitemap’. Sitemaps are used to create elements of a user interface for making openHAB items accessible to the frontend interface.</p>

<p>For example the sitemap config line to produce the emonPi Power1 in the interface is as follows:</p>

<p><code class="highlighter-rouge">Text item=emonpi_ct1 icon="firstfloor"</code></p>

<p>And to produce the LightWaveRF control swithches:</p>

<p><code class="highlighter-rouge">Switch item=lwrf1 label="LWRF Plug 1"</code></p>

<p>See the full sitemap file used for this example on the open_openhab GitHub repo (see docs link below).</p>

<p>I have intentionally kept this ‘skeleton’ example as simple as possible. To view the full capabilities of openHAB including using groups checkout the openHAB demo and corresponding demo items and sitemap files.</p>

<h3 id="documentation--source-code">Documentation &amp; Source Code</h3>

<p><strong><a href="https://github.com/openenergymonitor/oem_openhab">emonPi OpenHAB</a></strong></p>

<h3 id="related-blog-posts">Related Blog Posts</h3>

<p><a href="https://blog.openenergymonitor.org/2015/12/openenergymonitor-emonpi-and-openhab/">OpenEnergyMonitor, emonPi and openHAB</a></p>


</article>



    <footer>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <style>


</style>
<div class="copyright">

  <a rel="me" href='https://twitter.com/openenergymon'><i title="Twitter" class="icon-twitter"></i></a>
  <a rel="me" href='https://github.com/openenergymonitor/guide'><i title="GitHub" class="icon-github"></i></a>
  <a rel="me" href='http://blog.openenergymonitor.org'><i title="Blog" class="icon-bullhorn"></i></a>

  <div class="credit">
    Website powered by <a href='http://jekyllrb.com/'>Jekyll</a> and <a href='https://github.com/coogie/oscailte'>Oscalite</a>.<br />
    Hosted by <a href='https://pages.github.com/'>GitHub</a> and served by <a href='https://cloudflare.com'>CloudFlare</a>.
  </div>

</div>
    </div>
  </div>
</div>
    </footer>

    <!--[if lt IE 7]>
      <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->

    <script>
  var _gaq=[['_setAccount','UA-10321170-5'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>



<script>
  $(document).ready(function(){
    if (!window.jXHR){
      var jxhr = document.createElement('script');
      jxhr.type = 'text/javascript';
      jxhr.src = '/javascripts/libs/jXHR.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jxhr, s);
    }

    github.showRepos({
      user: 'openenergymonitor',
      count: 5,
      skip_forks: true,
      target: '#gh_repos'
    });
  });
</script>
<script src="/javascripts/github.js"></script>

  </body>
</html>